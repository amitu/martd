package main

import (
	"bytes"
	"compress/gzip"
	"io/ioutil"
	"net/http"
	"os"
	"path"
	"sync"
	"time"
)

type localFS struct{}

var local localFS

type staticFS struct{}

var static staticFS

type file struct {
	compressed string
	size       int64
	local      string
	isDir      bool

	data []byte
	once sync.Once
	name string
}

func (_ localFS) Open(name string) (http.File, error) {
	f, present := data[name]
	if !present {
		return nil, os.ErrNotExist
	}
	return os.Open(f.local)
}

func (_ staticFS) Open(name string) (http.File, error) {
	f, present := data[path.Clean(name)]
	if !present {
		return nil, os.ErrNotExist
	}
	var err error
	f.once.Do(func() {
		f.name = path.Base(name)
		if f.size == 0 {
			return
		}
		var gr *gzip.Reader
		gr, err = gzip.NewReader(bytes.NewBufferString(f.compressed))
		if err != nil {
			return
		}
		f.data, err = ioutil.ReadAll(gr)
	})
	if err != nil {
		return nil, err
	}
	return f.File()
}

func (f *file) File() (http.File, error) {
	return &httpFile{
		Reader: bytes.NewReader(f.data),
		file:   f,
	}, nil
}

type httpFile struct {
	*bytes.Reader
	*file
}

func (f *file) Close() error {
	return nil
}

func (f *file) Readdir(count int) ([]os.FileInfo, error) {
	return nil, nil
}

func (f *file) Stat() (os.FileInfo, error) {
	return f, nil
}

func (f *file) Name() string {
	return f.name
}

func (f *file) Size() int64 {
	return f.size
}

func (f *file) Mode() os.FileMode {
	return 0
}

func (f *file) ModTime() time.Time {
	return time.Time{}
}

func (f *file) IsDir() bool {
	return f.isDir
}

func (f *file) Sys() interface{} {
	return f
}

// FS returns a http.Filesystem for the embedded assets. If useLocal is true,
// the filesystem's contents are instead used.
func FS(useLocal bool) http.FileSystem {
	if useLocal {
		return local
	}
	return static
}

var data = map[string]*file{

	"/client.js": {
		local:      "client.js",
		size:       2677,
		compressed: "\x1f\x8b\b\x00\x00\tn\x88\x00\xff\x8cVko\xdb6\x17\xfe,\xff\n\xbe\xfe\x10Qod9i\x86\x14p\x90\x15CQ\xac\x1b\x96\xa6\x98=,@\x10\x14\xb4tlˑI\x8f\xa4b\x1bm\xfe\xfb\x0e/\xba\xf9\x12,\x1f\"\x89<\xb7\xe7\xe1s\x0e=\x1c\x92\x85\xd6k5\x1a\x0e\xe7\xb9\xd2\xc9<\u05cbr\x9a\xa4b5|\x00\xc1S)\x94\x1a\xbe\xbf\xbe\xbez\xf7\xfe\xaa\xd7\xdb\xe4<\x13\x9bdŤ\xce\xc8-\x99\x95<չ\xe04\"\xdf{\xc1\v\x93\x84-ٶ\xb5Ah)\x8b\x98dL\xb3\x98\xa4\xac(\xa6,}\x8e\th6\xb7.\xd6\xc78p\xd8P\xbd\xc8U\xf2p\xf7\xc7g\xac\xe7O\xf8\xa7\x04\xa5ɏ\x1f\xe4\x17\x8c\xf4\x02\x0f\xf7\xd3%\xa4:\xa2\xe1\xdd\x18m\xdeY\xc3\xc9\xe4kr\x95\\\x84\xd1\r\x86\xda&b\r\x9c\x9a\\\xe4\x03\t\xbfޏ'!\x19\x91\xf0\xd7O\x930&\xb6\x8eKk\x98\xcf\bm*@?\x05\xda\xe7\xfb\f,\x03I\xc3\xdff\x83/\x82\xc3\xe0\x8e\xe9t\x11\xfa\x82\x8d\xefk\xef\xb8\xc3\xc3\xc0/@6\xf8\x1b)D\x9f\xb0\v\xa5*\xf2\xd0\xf7\xa3\xe0\x1a\xb8\x1e\xe8\xdd\x1a\x8c\x1f[\xaf\x8b<e\x86\xbf\xe1v\xb0\xd9l\x063!W\x03D\x00<\x15\x19d5^.1\xc4Ni\xa6!]0>\x87\x0e\xf55>k56V\xe4grE\xce\xce\xea\xa3h\xbfSc\xa8ւ+\x98\xc0V\xc7d\xeb\x10We\xf3\xccrk\x17%\xe8Rr\xb2\xc5w\xdc\xef\x05uR\xf5\x93O\xeb-\x90\xc0E2+\x84\x90\xd4\xd4B/ɹ[\x93\f\x95\xb4\xa2QD\xfeO.\xb6\x97\x17\xf8\x87\x06Q\xa2\xc5X˜\xcf\xe9\xe5u\x94\xa8r\xaa\xfc\x97I\xfb\xdas\"\x9b\x97\xf9\xa1\xfa\xaa\x8c6\x8f-\xe3\x9c\xf8G8\b\xdf\xfah9t6[\x0fSZ\x85\xd5TP5\xc0wÎ\xfd@\xee\x9cbQ\xcbeQ\xd4\xcb\xe6\\8\x14\xaak\x9cZ\x00\x06\a\x8d\xeaEx\x01\xf9mZ\xae\xd6`ѱBA\xbd\x87\nH\x91\x87oi!\x144\xbb\xd56\x12\xd5&\xc4$u\xa2Ů\x9b6\x9d\xe6\x8bA\xd3nq\x8f\xe6\xe5ɷ\xc6\xff\xfc\xaa\x97O\xe3c?\x03\xceV0\xb2\x91b\xfbm\xb2\x8c\\.\xfb]\xc9I\x8d\x10\xb0Y\xb1\xff\x8e\xe5Ð~\xc1u\x96/r\xde\xe5\xa6* \xa9\x03?\xa2\x85u\x9e\x1a\x02l\xcd\a\x04\xfa\xe2\x9b=\u007f<~\xbd{f\t\x9b\n\xa9]\xb6\xe0\x04\xe1Z\x96pS\xc1y%\b\x02\\\xa8cgW\x1b\x9b\x15\x1a\xd5\xf0\xbcD\xad\x1f\x82\x18\x19\xac\x96\xb5\x94\xf1\x14\x8aѾ\xa4\x83 \x83\x02\xb0m\x8fsP\x97Ӵ\x86Ix\xd8\x1af\a\xc7\an\xf4\x87(\x95\x0f(\xbf\xdb>J\xbb\x16\xa3\xa9\x10\x11\x13\xab\x1c\x92\xf3=}\xb4\xd8tc8y\x86\x9d\xa2\xc7\x0e\xb5)1Jp^\xcd\xf5\x02g\xceE\x05\xc7\x14q~Kh\xff̤\xb7\xc9\xceI\xbf]K7X=w+\x9c\a\xcdf.\x1cw\xc9ؖ\x88[\xf3O\xe3\x14\x8bڇtТA\xa0\xe5Ηf82\xf3\x0fw\u007f\x1f\xdf\u007fI\xd6L*p1\x9c.:\xfc\x18\xcb}z|\xfb\x1c\x03R[\x04)\xceWQ@R\x889\xed\xffş\xb9\xd8\xf0\xeaxG\xa4\x1f\xdb\xf7\xa81\xd69\xf7Z\xf2\x9d\xe4\v\xc9\x0f\xaa\xf0\x94\xadٮ\x10,k2\x1a`~\x11\xb1\xbd\xe1\xf2\x98?\xf9D.\xc5\xf2P\b\ag\\gi1\x19\x9c\xe8\xf7\x96z\x97O\xb4\xaa\xb3J\x89M\x95\x9a\xdb\x16\xeff)[q;\x8cՋA\xffcu\x85}\x92RHK\x1d:\xc6\x15TGdL\x96\xb5K+S\xaf\xf3\xf4\x8f\x93\x02<\xc1\x9a\xd9r!]\x00\xff\xdb\b\xef\xf7I\xbe\x02Qjj\x9a1F\xf1;\x01\x1f\x81\u05cc\xa7θ\xa9ѿ9\xfb\x83\xff\x90\xb43\xa9\\\xbeVW\xec\xcbq\x8fɖ\xf6+\x8eN\xa53\xf7w\xd4\"\xc3v\xab\xbb\xb2\xab\xa1g\xb1\xdc\xf4^\xcd8\xfc7\x00\x00\xff\xff\xe66&\xd5u\n\x00\x00",
	},

	"/index.html": {
		local:      "index.html",
		size:       534,
		compressed: "\x1f\x8b\b\x00\x00\tn\x88\x00\xff|\x92\xc1n\x84 \x10\x86\xcf\xeeSLH\x0f\x9a\x1a\xb1\x1ewY/}\x85&=\xb3@W\x1a\x04\x03c7M\xd3w/\xa0i܃{\x9a\xc9\xcf\xff3\x1f\x19\u0600\xa3\xe9\x0f\x05\x1b\x14\x97\xb1\x16\f5\x1aՏܣ\x04\xa9F\xc7\xe8\xa2D\x0f]M\xec\xe2\xe4w6\a\xe1\xf5\x84\x10\xbc8\x13a\xb4\xb2\xd8|\x06\xd23\xba\x1cl<\xa9-(\x85\xa7\x92\xa44\xa9\x1a>M\xcaʒ\xb0ɫ\xfe\x9dk\xd4\xf6\x9a{6\xf8\x9eT\xa7CJ|q\x0f\x03\xb7\xd2(8C\x86j\xc2|)\x89x!5\xb45|\xccV\xa0v\xb6\x94\x1cy\xf5\x93\"\x85p68\xa3\x1a㮋|\xca\xf2\xfep\x02ϐ\x8c\xb1\x90;\x82\x98\xfa]An\xdaJwk\x82\xc27=*7c\x99/\xfd\x9f\xbf\xce\xde\a\xee\xf6\x81\uf463\xf5\x18\xbd\x1b\xf2G\xec\xaf\xdd\x11\x1e\xf1//ȵ\x86\xaem\xdb\xd4ge\xb3$F\x97\x8d\xc6\r\xe7\xef\xf0\x17\x00\x00\xff\xff%\t\xeaf\x16\x02\x00\x00",
	},

	"/": {
		isDir: true,
	},
}
